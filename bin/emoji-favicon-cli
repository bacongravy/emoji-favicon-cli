#!/usr/bin/env node

const meow = require('meow');
const engine = require('../src');

const cli = meow(
  `
  Usage
    $ emoji-favicon-cli [<emoji-name> [<destination>]]

  Options
    --provider <provider>  Choose the provider to get the image from.
                            (github [default], webfx)

  Examples
    $ emoji-favicon-cli
    $ emoji-favicon-cli tada
    $ emoji-favicon-cli ghost public
`,
  {
    flags: {
      provider: {
        type: 'string',
        default: 'github',
      },
    },
  },
);

if (cli.input.length > 2) {
  console.error('ERROR: Too many arguments');
  cli.showHelp();
}

const getEmoji = async () =>
  cli.input.length > 0 ? cli.input[0] : engine.interactive();

const runEngine = async (emoji) =>
  engine[cli.flags.provider](emoji, ...cli.input.slice(1));

getEmoji().then(runEngine).catch(console.error);
